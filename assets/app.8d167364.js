(function(){"use strict";var e={5248:function(e,t,n){var a=n(3751),o=n(641);function s(e,t){const n=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(n)}var r=n(6262);const l={},c=(0,r.A)(l,[["render",s]]);var i=c,u=n(5220),v=(n(4114),n(33)),p=n(953),d=(n(8111),n(2489),n(7588),n(1701),n(4335));const m="sk-ccbec3a34599494f8cdd5ed2add8363e",f="https://api.deepseek.com/v1/chat/completions",h=d.A.create({baseURL:f,headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}}),g=["医院","学校","办公室","森林","海边","太空站","古寺庙","未来城市","火车上","沙漠","海底","雪山"],k=()=>{const e=Math.floor(Math.random()*g.length);return g[e]},b=async()=>{try{const e=k(),t=await h.post("",{model:"deepseek-chat",messages:[{role:"system",content:'你是一个海龟汤游戏主持人。请生成一个包含多个核心条件的海龟汤谜题，格式必须严格遵循：\n1. 首先输出"谜题："，然后是谜题描述\n2. 然后输出"核心条件："，列出3-5个解开谜题必须满足的关键条件，用数字编号\n3. 最后输出"汤底："，然后是完整答案。\n不要添加任何额外内容或解释。'},{role:"user",content:`请生成一个发生在${e}场景的海龟汤谜题，确保包含3-5个核心条件。`}],max_tokens:500,temperature:1.1,top_p:.9}),n=t.data.choices[0].message.content;console.log("生成谜题原始响应:",n);const a=n.match(/谜题：([\s\S]*?)核心条件：/),o=n.match(/核心条件：([\s\S]*?)汤底：/),s=n.match(/汤底：([\s\S]*)/);if(!a||!o||!s)throw new Error("无法解析谜题格式，缺少必要部分");const r=o[1].split(/\d+\./).filter(e=>e.trim()).map(e=>e.trim()),l=a[1].trim(),c=s[1].trim();return console.log("解析结果 - 谜题:",l),console.log("解析结果 - 核心条件:",r),console.log("解析结果 - 汤底:",c),{puzzle:l,answer:c,conditions:r}}catch(e){throw console.error("生成谜题失败:",e.response?.data||e.message),new Error("无法生成谜题，请稍后重试")}},y=async(e,t,n,a,o)=>{const s=Array.isArray(a)?a:[],r=[{role:"system",content:`你是一个海龟汤游戏主持人。根据以下谜题情境和汤底，回答用户的问题：\n      \n      谜题情境: ${e}\n      汤底答案: ${t}\n      \n      回答规则:\n      1. 只根据汤底答案判断用户问题的正确性\n      2. 如果用户的问题与汤底一致，回答"是"\n      3. 如果用户的问题与汤底矛盾，回答"否"\n      4. 如果问题与汤底无关或无法判断，回答"无关"\n      5. 只返回"是"、"否"或"无关"，不要有任何多余文字\n      6. 如果用户完全猜中了汤底，回答格式："[完全正确]恭喜你完全猜对了！"，不要包含汤底内容`}];s.forEach(e=>{e&&"object"===typeof e&&e.role&&e.content&&r.push({role:e.role,content:e.content})}),r.push({role:"user",content:o});try{const e=await h.post("",{model:"deepseek-chat",messages:r,max_tokens:50,temperature:.5,top_p:.7}),t=e.data.choices[0].message.content.trim();if(console.log("API原始响应:",t),t.startsWith("[完全正确]"))return{answer:"是",isCorrect:!0};{const e=["是","否","无关"],n=e.includes(t)?t:"无关";return{answer:n,isCorrect:!1}}}catch(l){throw console.error("提问失败:",l.response?.data||l.message),console.error("请求参数:",JSON.stringify(r,null,2)),new Error("无法获取回答，请稍后重试")}};const w={class:"game-container"},L={class:"chat-container",id:"chatContainer"},_={class:"message-list"},C={class:"message-left"},E={class:"message-bubble"},O={class:"timestamp"},S={key:0,class:"message-left"},X={class:"message-bubble"},j={class:"timestamp"},A={key:1,class:"loading"},K={class:"loading-text"},x={class:"message-bubble"},R={class:"timestamp"},D={key:2,class:"game-over"},T={key:0,class:"input-area"},I=["disabled"],z=["disabled"];var P={__name:"GameContainer",setup(e){const t=(0,p.KR)(!1),n=(0,p.KR)(""),s=(0,p.KR)(!1),r=(0,p.KR)(""),l=(0,p.KR)(""),c=(0,p.KR)([]),i=(0,p.KR)(""),u=(0,p.KR)([]),d=e=>{const t=new Date(e);return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},m=async()=>{t.value=!0,n.value="正在获取题目...",s.value=!1,c.value=[],r.value="",i.value="",u.value=[],l.value="";try{const{puzzle:e,answer:t}=await b();r.value=e,i.value=t}catch(e){r.value="游戏加载失败，请刷新页面重试",console.error("游戏初始化失败:",e)}finally{t.value=!1,g()}},f=async()=>{if(!l.value.trim()||s.value)return;const e=l.value.trim();l.value="",c.value.push({role:"user",content:e,timestamp:Date.now()}),g(),t.value=!0,n.value="正在思考...";try{const{answer:t,isCorrect:n,conditions:a}=await y(r.value,i.value,[],c.value,e);c.value.push({role:"assistant",content:t,timestamp:Date.now()}),n&&(s.value=!0,u.value=Array.isArray(a)?a:[])}catch(a){c.value.push({role:"assistant",content:"获取回答失败，请重试",timestamp:Date.now()}),console.error("提问处理失败:",a)}finally{t.value=!1,g()}},h=()=>{m()},g=()=>{(0,o.dY)(()=>{const e=document.getElementById("chatContainer");e&&(e.scrollTop=e.scrollHeight)})};return(0,o.sV)(()=>{m()}),(e,p)=>((0,o.uX)(),(0,o.CE)("div",w,[p[6]||(p[6]=(0,o.Lk)("div",{class:"bg-decoration"},null,-1)),p[7]||(p[7]=(0,o.Lk)("div",{class:"navbar"},[(0,o.Lk)("h1",null,"海龟汤游戏")],-1)),(0,o.Lk)("div",L,[(0,o.Lk)("div",_,[p[5]||(p[5]=(0,o.Lk)("div",{class:"system-message"},[(0,o.Lk)("span",null,"游戏开始")],-1)),(0,o.Lk)("div",C,[(0,o.Lk)("div",E,[p[1]||(p[1]=(0,o.Lk)("p",null,'欢迎来到海龟汤游戏！我会回答"是"、"否"或"无关"，请开始提问。',-1)),(0,o.Lk)("span",O,(0,v.v_)(d(Date.now())),1)])]),r.value?((0,o.uX)(),(0,o.CE)("div",S,[(0,o.Lk)("div",X,[(0,o.Lk)("p",null,(0,v.v_)(r.value),1),(0,o.Lk)("span",j,(0,v.v_)(d(Date.now())),1)])])):(0,o.Q3)("",!0),t.value?((0,o.uX)(),(0,o.CE)("div",A,[p[2]||(p[2]=(0,o.Lk)("div",{class:"spinner"},null,-1)),(0,o.Lk)("span",K,(0,v.v_)(n.value),1)])):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.value,(e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:(0,v.C4)("assistant"===e.role?"message-left":"message-right")},[(0,o.Lk)("div",x,[(0,o.Lk)("p",null,(0,v.v_)(e.content),1),(0,o.Lk)("span",R,(0,v.v_)(d(e.timestamp)),1)])],2))),128)),s.value?((0,o.uX)(),(0,o.CE)("div",D,[p[3]||(p[3]=(0,o.Lk)("h3",null,"游戏结束",-1)),p[4]||(p[4]=(0,o.Lk)("p",null,"核心条件：",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(u.value,(e,t)=>((0,o.uX)(),(0,o.CE)("li",{key:t},(0,v.v_)(e),1))),128))]),(0,o.Lk)("p",null,"汤底："+(0,v.v_)(i.value),1),(0,o.Lk)("button",{onClick:h},"再来一局")])):(0,o.Q3)("",!0)])]),s.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",T,[(0,o.Lk)("form",{onSubmit:(0,a.D$)(f,["prevent"])},[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":p[0]||(p[0]=e=>l.value=e),type:"text",placeholder:"输入你的问题...",disabled:t.value},null,8,I),[[a.Jo,l.value]]),(0,o.Lk)("button",{type:"submit",disabled:!l.value.trim()||t.value}," 发送 ",8,z)],32)]))]))}};const $=(0,r.A)(P,[["__scopeId","data-v-338d756e"]]);var F=$;const M={class:"min-h-screen bg-gradient-to-b from-indigo-50 to-white"};var Q={__name:"GameView",setup(e){return(e,t)=>((0,o.uX)(),(0,o.CE)("div",M,[(0,o.bF)(F)]))}};const B=(0,r.A)(Q,[["__scopeId","data-v-59302ca8"]]);var V=B;const G=[{path:"/",name:"game",component:V}],J=(0,u.aE)({history:(0,u.Bt)(),routes:G});var U=J;(0,a.Ef)(i).use(U).mount("#app")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,s){if(!a){var r=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],s=e[u][2];for(var l=!0,c=0;c<a.length;c++)(!1&s||r>=s)&&Object.keys(n.O).every(function(e){return n.O[e](a[c])})?a.splice(c--,1):(l=!1,s<r&&(r=s));if(l){e.splice(u--,1);var i=o();void 0!==i&&(t=i)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[a,o,s]}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,s,r=a[0],l=a[1],c=a[2],i=0;if(r.some(function(t){return 0!==e[t]})){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(c)var u=c(n)}for(t&&t(a);i<r.length;i++)s=r[i],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},a=self["webpackChunkai"]=self["webpackChunkai"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],function(){return n(5248)});a=n.O(a)})();