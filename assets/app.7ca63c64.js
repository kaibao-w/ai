(function(){"use strict";var e={8421:function(e,t,n){var a=n(3751),s=n(641);function o(e,t){const n=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.Wv)(n)}var r=n(6262);const l={},i=(0,r.A)(l,[["render",o]]);var c=i,u=n(5220),v=(n(4114),n(33)),p=n(953),m=(n(8111),n(2489),n(7588),n(1701),n(4335));const d="sk-ccbec3a34599494f8cdd5ed2add8363e",h="https://api.deepseek.com/v1/chat/completions",f=m.A.create({baseURL:h,headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}}),g=["医院","学校","办公室","森林","海边","太空站","古寺庙","未来城市","火车上","沙漠","海底","雪山"],b=()=>{const e=Math.floor(Math.random()*g.length);return g[e]},k=async()=>{try{const e=b(),t=await f.post("",{model:"deepseek-chat",messages:[{role:"system",content:'你是一个海龟汤游戏主持人。请生成一个包含多个核心条件的海龟汤谜题，格式必须严格遵循：\n1. 首先输出"谜题："，然后是谜题描述\n2. 然后输出"核心条件："，列出3-5个解开谜题必须满足的关键条件，用数字编号\n3. 最后输出"汤底："，然后是完整答案。\n不要添加任何额外内容或解释。'},{role:"user",content:`请生成一个发生在${e}场景的海龟汤谜题，确保包含3-5个核心条件。`}],max_tokens:500,temperature:1.1,top_p:.9}),n=t.data.choices[0].message.content;console.log("生成谜题原始响应:",n);const a=n.match(/谜题：([\s\S]*?)核心条件：/),s=n.match(/核心条件：([\s\S]*?)汤底：/),o=n.match(/汤底：([\s\S]*)/);if(!a||!s||!o)throw new Error("无法解析谜题格式，缺少必要部分");const r=s[1].split(/\d+\./).filter(e=>e.trim()).map(e=>e.trim()),l=a[1].trim(),i=o[1].trim();return console.log("解析结果 - 谜题:",l),console.log("解析结果 - 核心条件:",r),console.log("解析结果 - 汤底:",i),{puzzle:l,answer:i,conditions:r}}catch(e){throw console.error("生成谜题失败:",e.response?.data||e.message),new Error("无法生成谜题，请稍后重试")}},y=async(e,t,n,a,s)=>{const o=Array.isArray(a)?a:[],r=[{role:"system",content:`你是一个海龟汤游戏主持人。根据以下谜题情境、核心条件和汤底，回答用户的问题：\n      \n      谜题情境: ${e}\n      核心条件: ${n.map((e,t)=>`${t+1}. ${e}`).join("\n")}\n      汤底答案: ${t}\n      \n      回答规则:\n      1. 首先判断用户的问题是否涉及核心条件\n      2. 如果用户完全猜对所有核心条件，回答格式："[完全正确]恭喜你完全猜对了！汤底是：${t}"\n      3. 如果用户猜对部分核心条件，回答格式："[部分正确]你猜对了：[正确条件]，还缺少：[缺少条件]"\n      4. 如果用户没有猜对任何核心条件，根据问题内容回答"是"、"否"或"无法回答"\n      5. 只返回上述规定的内容，不要有任何多余文字`}];o.forEach(e=>{e&&"object"===typeof e&&e.role&&e.content&&r.push({role:e.role,content:e.content})}),r.push({role:"user",content:s});try{const e=await f.post("",{model:"deepseek-chat",messages:r,max_tokens:200,temperature:.5,top_p:.7}),t=e.data.choices[0].message.content.trim();return console.log("API原始响应:",t),t.startsWith("[完全正确]")?{answer:t.replace("[完全正确]","").trim(),isCorrect:!0,partial:!1,hint:""}:t.startsWith("[部分正确]")?{answer:t.replace("[部分正确]","").trim(),isCorrect:!1,partial:!0,hint:t.replace("[部分正确]","").trim()}:{answer:t,isCorrect:!1,partial:!1,hint:""}}catch(l){throw console.error("提问失败:",l.response?.data||l.message),console.error("请求参数:",JSON.stringify(r,null,2)),new Error("无法获取回答，请稍后重试")}};const w={class:"game-container"},L={class:"chat-container",id:"chatContainer"},C={class:"message-list"},_={class:"message-left"},E={class:"message-bubble"},O={class:"timestamp"},j={key:0,class:"message-left"},S={class:"message-bubble"},X={class:"timestamp"},A={key:1,class:"loading"},K={class:"loading-text"},x={class:"message-bubble"},R={class:"timestamp"},$={key:2,class:"game-over"},D={key:0,class:"input-area"},T=["disabled"],I=["disabled"];var z={__name:"GameContainer",setup(e){const t=(0,p.KR)(!1),n=(0,p.KR)(""),o=(0,p.KR)(!1),r=(0,p.KR)(""),l=(0,p.KR)(""),i=(0,p.KR)([]),c=(0,p.KR)(""),u=(0,p.KR)([]),m=e=>{const t=new Date(e);return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},d=async()=>{t.value=!0,n.value="正在获取题目...",o.value=!1,i.value=[],r.value="",c.value="",u.value=[],l.value="";try{const{puzzle:e,answer:t}=await k();r.value=e,c.value=t}catch(e){r.value="游戏加载失败，请刷新页面重试",console.error("游戏初始化失败:",e)}finally{t.value=!1,g()}},h=async()=>{if(!l.value.trim()||o.value)return;const e=l.value.trim();l.value="",i.value.push({role:"user",content:e,timestamp:Date.now()}),g(),t.value=!0,n.value="正在思考...";try{const{answer:t,isCorrect:n,conditions:a}=await y(r.value,c.value,[],i.value,e);i.value.push({role:"assistant",content:t,timestamp:Date.now()}),n&&(o.value=!0,u.value=Array.isArray(a)?a:[])}catch(a){i.value.push({role:"assistant",content:"获取回答失败，请重试",timestamp:Date.now()}),console.error("提问处理失败:",a)}finally{t.value=!1,g()}},f=()=>{d()},g=()=>{(0,s.dY)(()=>{const e=document.getElementById("chatContainer");e&&(e.scrollTop=e.scrollHeight)})};return(0,s.sV)(()=>{d()}),(e,p)=>((0,s.uX)(),(0,s.CE)("div",w,[p[6]||(p[6]=(0,s.Lk)("div",{class:"navbar"},[(0,s.Lk)("h1",null,"海龟汤游戏")],-1)),(0,s.Lk)("div",L,[(0,s.Lk)("div",C,[p[5]||(p[5]=(0,s.Lk)("div",{class:"system-message"},[(0,s.Lk)("span",null,"游戏开始")],-1)),(0,s.Lk)("div",_,[(0,s.Lk)("div",E,[p[1]||(p[1]=(0,s.Lk)("p",null,'欢迎来到海龟汤游戏！我会回答"是"、"否"或"无法回答"，请开始提问。',-1)),(0,s.Lk)("span",O,(0,v.v_)(m(Date.now())),1)])]),r.value?((0,s.uX)(),(0,s.CE)("div",j,[(0,s.Lk)("div",S,[(0,s.Lk)("p",null,(0,v.v_)(r.value),1),(0,s.Lk)("span",X,(0,v.v_)(m(Date.now())),1)])])):(0,s.Q3)("",!0),t.value?((0,s.uX)(),(0,s.CE)("div",A,[p[2]||(p[2]=(0,s.Lk)("div",{class:"spinner"},null,-1)),(0,s.Lk)("span",K,(0,v.v_)(n.value),1)])):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:(0,v.C4)("assistant"===e.role?"message-left":"message-right")},[(0,s.Lk)("div",x,[(0,s.Lk)("p",null,(0,v.v_)(e.content),1),(0,s.Lk)("span",R,(0,v.v_)(m(e.timestamp)),1)])],2))),128)),o.value?((0,s.uX)(),(0,s.CE)("div",$,[p[3]||(p[3]=(0,s.Lk)("h3",null,"游戏结束",-1)),p[4]||(p[4]=(0,s.Lk)("p",null,"核心条件：",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},(0,v.v_)(e),1))),128))]),(0,s.Lk)("p",null,"汤底："+(0,v.v_)(c.value),1),(0,s.Lk)("button",{onClick:f},"再来一局")])):(0,s.Q3)("",!0)])]),o.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",D,[(0,s.Lk)("form",{onSubmit:(0,a.D$)(h,["prevent"])},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":p[0]||(p[0]=e=>l.value=e),type:"text",placeholder:"输入你的问题...",disabled:t.value},null,8,T),[[a.Jo,l.value]]),(0,s.Lk)("button",{type:"submit",disabled:!l.value.trim()||t.value}," 发送 ",8,I)],32)]))]))}};const P=(0,r.A)(z,[["__scopeId","data-v-65b5d76c"]]);var F=P;const M={class:"min-h-screen bg-gradient-to-b from-indigo-50 to-white"};var Q={__name:"GameView",setup(e){return(e,t)=>((0,s.uX)(),(0,s.CE)("div",M,[(0,s.bF)(F)]))}};const B=(0,r.A)(Q,[["__scopeId","data-v-59302ca8"]]);var V=B;const W=[{path:"/",name:"game",component:V}],G=(0,u.aE)({history:(0,u.Bt)(),routes:W});var J=G;(0,a.Ef)(c).use(J).mount("#app")}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,a,s,o){if(!a){var r=1/0;for(u=0;u<e.length;u++){a=e[u][0],s=e[u][1],o=e[u][2];for(var l=!0,i=0;i<a.length;i++)(!1&o||r>=o)&&Object.keys(n.O).every(function(e){return n.O[e](a[i])})?a.splice(i--,1):(l=!1,o<r&&(r=o));if(l){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,s,o]}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,o,r=a[0],l=a[1],i=a[2],c=0;if(r.some(function(t){return 0!==e[t]})){for(s in l)n.o(l,s)&&(n.m[s]=l[s]);if(i)var u=i(n)}for(t&&t(a);c<r.length;c++)o=r[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},a=self["webpackChunkai"]=self["webpackChunkai"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],function(){return n(8421)});a=n.O(a)})();